%Thus we may solve this problem by solving $n$ sparse linear systems of that take the form $Ax = b$, where here $A$ is a Laplacian matrix with an $\epsilon \cdot I_n$ addition to it's diagonal. 
\subsection{Parameterized Laplacians}\label{sec:laplacian_theory2}
 For the sake of generality, it is important to make the class of expressions for $\beta_p^\ast$ and $\mu_p^\ast$ as large as possible.
%elucidate the necessary conditions under which the spectral operators from section~\ref{sec:spectral_relax} are differentiable, so as to make the class of such operators as large as possible. 
Towards this, we exploit another identity of the rank function applicable to zero-characteristic fields $\mathbb{F}$:
% for zero characteristic fields: 
%$$\mathrm{rank}(\partial_p) = \mathrm{rank}(\partial_p \circ \partial_p^T) = \mathrm{rank}(\partial_p^T \circ \partial_p)$$ 
$$\mathrm{rank}(X) = \mathrm{rank}(X X^T) = \mathrm{rank}(X^T X), \quad \text{for all } X \in \mathbb{F}^{n \times m}$$ 
% study of spectra of \emph{combinatorial Laplacians}
In the context of boundary operators, note that $\partial_0 = 0$ and $\partial_1 \partial_1^T$ is the well known \emph{graph Laplacian}~\cite{chung1997spectral}, thus we may express $\beta_0^\ast(\alpha)$ and $\mu_0^\ast(\alpha)$ using the ranks of Laplacian matrices. 
More generally, for $p > 1$ and any simplicial complex $K$, the \emph{$p$-th combinatorial Laplacian} $\Delta_p$ of $K$ is given by: 
\begin{equation}\label{eq:comb_lap}
	\Delta_p(K) = \underbrace{\partial_{p\+1} \circ \partial_{p\+1}^T}_{L_p^{\text{up}}} + \underbrace{\partial_{p}^T  \circ  \partial_{p}}_{L_p^{\text{dn}}} 
%	\simeq H() 
\end{equation}
\noindent 
All three operators $\Delta_p$, $L_p^{\text{up}}$, and $L_p^{\text{dn}}$ are symmetric, positive semi-definite, and compact~\cite{memoli2022persistent}---moreover, the inertia of their spectra is equivalent, implying they must have identical ranks~\cite{horak2013spectra}. Thus, from a rank-based perspective, it suffices to consider any one of these operators.
Indeed, a direct result of the singular value decomposition (SVD) is that we may substitute the study of singular values of boundary operators with the spectra of Laplacians.  


%moreover, as shown by~\cite{horak2013spectra}, their spectra are related by the identities $\Lambda(\Delta_p(K)) \doteq \Lambda(L_p^{\text{up}}) \, \cupdot \, \Lambda(L_p^{\text{dn}})$ and $\Lambda(L_p^{\text{up}}) \doteq \Lambda(L_{p+1})$,
%where $A \doteq B$ and $A \cupdot B$ denotes equivalence and union between the \emph{non-zero} elements of the multisets $A$ and $B$, respectively.
%\begin{equation}\label{eq:lap_spectra_conn}
%	\Lambda(\Delta_p(K)) \doteq \Lambda(L_p^{\text{up}}) \stackrel{\cdot}{\cup} \Lambda(L_p^{\text{dn}}), \quad \quad \Lambda(L_p^{\text{up}}) \doteq \Lambda(L_{p+1}^{\text{dn}})
%\end{equation}

For completeness, we formalize the observations above. Let $(K, f_\alpha)$ denote parameterized family of filtrations of a simplicial complex equipped with a fixed but arbitrary linear extension $(K, \preceq)$ of the face poset of $K$. 
Let $\mathcal{L}_p^\ast$ denote any choice of $p$-Laplacian, which may generically of the forms given below: 
\begin{align}\label{eq:laplacian_decouple}
\mathcal{L}_p^{\text{up}}(\alpha) & \triangleq D_p^{1/2}(\alpha) \cdot \partial_{p+1}(K_\preceq) \cdot D_{p+1}(\alpha) \cdot \partial_{p+1}^T(K_\preceq) \cdot D_p^{1/2}(\alpha) \\ 
\mathcal{L}_p^{\text{dn}}(\alpha) & \triangleq D_p^{1/2}(\alpha) \cdot \partial_p^T(K_\preceq) \cdot D_{p+1}(\alpha) \cdot \partial_p(K_\preceq) \cdot D_p^{1/2}(\alpha) \\
\Delta_p(\alpha) & \triangleq \mathcal{L}_p^{\text{up}}(\alpha) + \mathcal{L}_p^{\text{dn}}(\alpha) 
\end{align}
where $D_p(\alpha)$ denotes a diagonal matrix whose entries represent non-negative weights on the $p$-simplices of $K$ that depend on $f_\alpha$. 
As before with~\eqref{eq:rank_equiv_param}, we may isolate certain sign patterns to obtain operators whose ranks match the constitutive terms. 	

%Unlike $\partial_p(\alpha)$, the set $\{ \, \hat{L}_p^{\mathrm{up}}(\alpha) : \alpha \in \mathcal{A} \, \}$ lies strictly within $\mathbb{S}^n_+$, implying $\lVert \Phi(\hat{L}_p^{\mathrm{up}})(\alpha) \rVert_\ast$ is continuously differentiable. 
%Moreover, Laplacian operators are known to encode rich geometric information in their spectra~\cite{horak2013spectra}, suggesting this geometric structure may now be used in a persistence setting. We give exemplary applications exploiting both facts in section~\ref{sec:applications}. 

% Maybe not relevent anymore
% We now describe an $\mathcal{A}$-parameterized variation of $L_p^{\mathrm{up}}$. Following~\cite{}, we write $X^+$ to denote the Moore-Penrose pseudoinverse and for brevity write $X^{+/2} = (X^{+})^{1/2}$. Using the decoupling observation from~\eqref{eq:decouple}, observe we may write the inner operator from~\cite{} as follows:
%$$ \hat{L}_p^{\text{up}}(\alpha) = D_p^{+/2}(f_\alpha) \circ \partial_p(K_{\preceq^\ast}) \circ D_{p+1}(f_\alpha) \circ \partial_p(K_{\preceq^\ast})^T \circ D_p^{+/2}(f_\alpha) $$ 
%Like $\partial_p(\alpha)$, the entries of $\hat{L}_p^{\text{up}}(\alpha)$ vary continuously in $\alpha$ and may be thresholded using step (or smoothstep) functions to yield any the constitutive terms from proposition~\ref{prop:mu_betti_1}. 
%Algebraically, 
%$\mathcal{L}_{a,b}(\cdot, \alpha) : C^p(K_b, K_a; \mathbb{R}) \to C^p(K_b, K_a; \mathbb{R})$
 
%Let $K$ denote a simplicial complex and parameters $(p, \epsilon, \omega)$ satisfying $p \geq 0$, $\epsilon > 0$, and $\omega > 0$, respectively, define the $\mathcal{A}$-parameterized  \emph{spectral multiplicity} of $R$ as:
%	\begin{equation}\label{eq:mu_cont_lap}
%	\hat{\mu}_{p,\epsilon}^R(\alpha) = 
%		 \lVert \Phi_{p\+1}^{j \+ \delta, k}) \rVert_\ast - 
%		 \lVert \Phi_\epsilon^\alpha(\hat{\partial}_{p\+1}^{i \+ \delta, k}) \rVert_\ast -  
%		 \lVert \Phi_\epsilon^\alpha(\hat{\partial}_{p\+1}^{j \+ \delta, l}) \rVert_\ast + 
%		 \lVert \Phi_\epsilon^\alpha(\hat{\partial}_{p\+1}^{i \+ \delta, l}) \rVert_\ast \numberthis
%	\end{equation}


%Note that, as with the other operators mentioned, the nullity is not affected by this normalization---the rank function is invariant under scalar products with identical sign.   

%Thus, we may retain the inner product interpretation from~\eqref{} while working with PSD operators---
%One shortcoming of the stability result shown above is that the Lipshitz constant depends explicitly on the magnitude of $f_\alpha$, which in-turn affects the stability of the proposed relaxation if $f_\alpha$ is scaled poorly, i.e. $\lambda \cdot f_\alpha$. 
%Moreover, the continuous differentiability of $\lVert \Phi_\epsilon(\cdot) \rVert_\ast$ only extends to linear operators defined over the positive semi-definite cone, and the explicit form of the differential $\partial \lVert \Phi_\epsilon(\cdot) \rVert_\ast$ depends on the domain of its corresponding spectral function $\phi(\cdot)$ being bounded to some interval $(a,b)$~\cite{bhatia2013matrix}.  
%
%Consider the $\mathcal{H}$-parameterized boundary matrix from Definition~\eqref{def:time_boundary_matrix}. Assume that the filter function $f : K \to \mathbb{R}_+$ is strictly positive. By taking the product $(\hat{\partial}_p^{i,j})(\hat{\partial}_p^{i,j})^T$ for some choice of $h \in \mathcal{H}$, we have:
%\begin{align*}\label{eq:param_up_lap}
%	\hat{L}_p^{\text{up}}(K, f) &= (\hat{\partial}_p^{i,j})(\hat{\partial}_p^{i,j})^T \\
%	&= (V_p^i)^{+} \circ \partial_p \circ (W_{p+1}^j)^2 \circ \partial_p^T \circ (V_p^i)^{+} \\
%	&\propto (V_p^i)^{+/2} \circ \partial_p \circ W_{p+1}^j \circ \partial_p^T \circ (V_p^i)^{+/2}  \numberthis
%\end{align*}
%where $A^{+/2} = (A^{1/2})^+$. 

%A second difficulty that arises with both the symmetric and asymmetric forms of~\eqref{eq:l_up} is the problem of unbounded spectra. It is not difficult to see that the inverse terms in~\eqref{eq:l_up} drive $\lVert L_p^{\textrm{up}}\rVert_2$ upwards indefinitely as $f(\sigma) \to 0^{+}$. 

%By choosing the weights, one effectively determines the corresponding inner product, which in-turn determines the spectral range of the corresponding operator.
%We expect the spectra of $\hat{L}_p^{\text{up}}$ to obey many of the properties enjoyed by $L_p^{\text{up}}$ and its variants. 
%Indeed, though the spectrum of $\hat{L}_p^{\text{up}}$ is unbounded for general choices of $f$, we show that the normalized up-Laplacian given by:
%\begin{equation}\label{eq:param_normalized_up_lap}
%	 \hat{\mathcal{L}}_p^{\text{up}}(K, f) = \mathcal{D}_p(\mathcal{S}_i \circ f_\alpha)^{+/2} \circ \partial_p \circ W_{p+1}(\mathcal{S}_j \circ f_\alpha) \circ \partial_p^T \circ (\mathcal{D}_p^i)^{+/2} 
%\end{equation}
%has its spectrum bounded in the interval $[0, p+2]$, where $\tilde{D}_p^i$ corresponds to the weighted degree matrix with entries $\{ \mathrm{deg}_w(\sigma) \}$. We defer discussion of the exact forms of these matrices, including the computational details the matrix-vector product $x \mapsto \hat{L}_p^{\text{up}}$, to section~\eqref{sec:comb_lap}. 



%\begin{remark}
%~\cite{} studied a persistent version of the~\eqref{}, a \emph{persistent laplacian}, whose nullity yields the persistent Betti number. Additionally, satisfies many attractive qualities one would want out of a laplacian, including multiplicity of its 0th eigenvalue, disjoint spectra of disjoint components, and connections to notions of effective resistance. 
%Thus, one would hope there to be a $p$-th persistent version of equation~\eqref{eq:laplace_hom} whose form is akin to ~\eqref{}, however as~\cite{} showed, the matrix representation. 
%\end{remark}

%In this effort, we consider a very general kind of combinatorial Laplacian. GHere, we define the combinatorial $p$-th weighted up-Laplacian of the triple $(w_{p}^l, w_{p+1}, w_{p}^r)$ by: 
%\begin{equation}\label{eq:weighted_up_laplace}
%	L_p^{\mathrm{up}}(K) := W_p^l \circ \partial_{p+1} \circ W_{p+1} \circ \partial_{p+1}^T \circ W_p^r
%\end{equation} 
%where $W_p^\ast = \mathrm{diag}(\{ w_i \})$ is a diagonal weight matrix whose corresponding weights are given by the appropriate function of $(w_{p}^l, w_{p+1}, w_{p}^r)$, respectively. 
%Setting all weight functions to the identity yields the combinatorial Laplacian~\cite{}. 
%When $p = 0$ and $K = (V,E)$ is a graph, setting the diagonal entries of $W_1$ to edge weights and $W_0^l = W_0^r = I$ yields Kirchoff's \emph{weighted graph Laplacian}. 
%Alternatively, setting $W_0^l[i,i] = 1/\mathrm{deg}(v_i)$ and $W_0^r = I$ yields the \emph{normalized graph Laplacian} studied by Chung~\cite{}.
%Setting $W_p^l[i,i] = w_{p}^l(\sigma_i)^{-1}$ for all $\sigma \in K^p$ and $W_p^r = I$ yields the \emph{up Laplacian} from~\cite{}.
%\begin{align*}\label{eq:up_laplace_2}
%	\tilde{L}_p^{\mathrm{up}} &= \partial_{p+1} W_{p+1} \partial_{p+1}^T W_p^{-1}  \\
%	&= W_p^{1/2} \left ( W_p^{-1/2}  \partial_{p+1} W_{p+1} \partial_{p+1}^T   W_p^{-\frac{1}{2}} \right ) W_p^{-\frac{1}{2}} \numberthis
%\end{align*}
%Note that $\tilde{L}_p^{\mathrm{up}}$ is not be symmetric matrix in general. However, like the vertex-weighted graph laplacian from~\cite{}, the expression from~\eqref{eq:up_laplace_2} is of the form $W^{-1} P W$ where $P$ is symmetric positive semi-definite and $W$ is a positive diagonal matrix. 



%\documentclass[10pt]{article}
%\usepackage[margin=0.5in]{geometry}
%\usepackage{amsmath, amsthm, amssymb}
%\usepackage{mathtools}
%\usepackage{hyperref}
%\usepackage{url}
%
%\DeclareMathOperator*{\argmax}{arg\,max}
%\DeclareMathOperator*{\argmin}{arg\,min}
%
%\title{\vspace{-2.0em} Interpreting the spectrum of the Graph Laplacian\vspace{-0.5em}}
%\author{Matt Piekenbrock}
%\date{}
%
%\begin{document} \vspace{-2em} \maketitle \vspace{-1em}
%Let $G = (V, E)$ denote a graph with vertex set $V = \{v_1, v_2, \dots, v_n\}$ and edge set $E \subseteq V \times V$. A weighted graph is a pair $(G, \mu)$ where $\mu: V \times V \to \mathbb{R}_+$ is an weight function satisfying $\mu_{v,v'} = \mu_{v', v}$, $\mu_{v,v'} > 0$ iff $(v,v') \in E$. Note that the last condition implies $\mu$ completely characterizes the connectivity of $G$, i.e. positive values of $\mu$ indicate the presence of edges. 
%
%We recall the Spectral Theorem, which characterizes the eiegnvlaues of a linear operator in terms of \emph{Rayleigh quotients}. If $U$ is a finite dimensional vector space and $A$ a linear operator on $U$, then for any non-zero $u \in U$, the Rayleigh quotient of $u$ is defined as: 
%$$ \mathcal{R}(u) = \frac{\langle Au, u \rangle}{\langle u, u\rangle}$$
%
%Any Laplacian operator $\mathcal{L} = A - D$ has a spectrum of $\lambda \in [0,2]$ for any $\lambda \in \Lambda(L)$.
%
%Let $(\lambda, f)$ denote a eigenvalue/eigenfunction pair of $L$, respectively. 
%$$\langle L f, f \rangle = \frac{1}{2} \sum\limits_{v \in V} \sum\limits_{v' \in V} \mu(v,v') \cdot \left(f(v) - f(v')\right)^2$$
%
%
%% From: Eigenvalues of the Laplacian on inhomogeneous membranes
%One can interpret the eigenvalues of the Laplacian physically as the frequencies of vibration of a membrane, as energy levels of a Hamiltonian in an infinite potential well, as rates of decay for the heat (or mass diffusion) equation, and as cut-off frequencies for waveguides.
%
%Two Laplacians $L_1$ and $L_2$ are cospectral if and only if $\alpha L_1 + \beta I + \gamma J$ and $\alpha L_2 + \beta I + \gamma J$ are (where $\alpha \neq 0$). 
%
%% Which graphs are determined by their spectrum?
%The following can be deduced from the spectrum of the adjacency matrix or Laplacian matrix of $G$: 
%\begin{enumerate}
%	\item The number of vertices
%	\item Number of edges
%	\item Whether $G$ is a regular 
%	\item Whether $G$ is regular with any fixed girth 
%\end{enumerate}
%Additional, the spectrum of the Laplacian contains information about 1. the number of connected components and 2. the number of unique spanning trees. The former is given by the algebraic multiplicity of the $0$ eigenvalue of $L$ (the corank of $L$), and the latter is given by---if $G$ is connected---$1/n$ times the product of $L$ non-zero eigenvalues. 
%
%There are many graphs which are determined by their spectrum (DS). 
%
%\end{document}
