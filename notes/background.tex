%\section{Background \& Notation}\label{sec:background_notation}
A \emph{simplicial complex} $K \subseteq \mathcal{P}(V)$ over a finite set $V = \{v_1, v_2, \dots, v_n \}$ is a collection of simplices $\{\, \sigma : \sigma \in \mathcal{P}(V) \,\}$ such that $\tau \subseteq \sigma \in K \Rightarrow \tau \in K$.
A \emph{$p$-simplex} $\sigma \subseteq V$ is a set of $p+1$ vertices, the collection of which is denoted as $K^p$.
%\{ \, \sigma \in K : \mathrm{dim}(\sigma) = p \, \}$ 
%$p$-simplices are denoted with $K^p$.
%The $p$-skeleton of $\mathrm{skel}_p(K)$ is the the restriction of $K$ to its simplices with dimension $\leq p$. 
%and by $K^{(p)} = \{ \, \sigma \in K : \mathrm{dim}(\sigma) \leq p \, \}$ the $p$-skeleton of $K$. 
%but for brevity refer to them simply as filtrations.
%\\
%\\
%\noindent
%\textbf{Remark 1:}
%\normalfont In practice, filtrations often arise from triangulations parameterized by geometric scaling parameters. 
%%and references to the ``persistence'' of a given homology class are with respect to these parameterizations.
%For example, given a finite metric space $\mathcal{X} = (X, d_X)$, the \emph{Rips complex} at scale $\epsilon \in \mathbb{R}_{+}$ is defined as: 
%\begin{equation}
%	\mathrm{Rips_{\epsilon}}(\mathcal{X}) := \{ \sigma \subseteq X : d_X(x, x') \leq \epsilon \text{ for all } x, x' \in \sigma \} 
%\end{equation}
%\noindent Connecting successive complexes via inclusions $\mathrm{Rips_{\epsilon}}(\mathcal{X}) \hookrightarrow \mathrm{Rips_{\epsilon'}}(\mathcal{X})$ for $\epsilon < \epsilon'$ yields a family of complexes $\mathrm{Rips}_{\alpha} := \{ \, \mathrm{Rips}_\epsilon(\mathcal{X}) \, \}_{\epsilon \leq \alpha}$ called the \emph{Rips filtration}. 
%We keep the notation general by letting $K_\bullet$ denote any filtration. 
%As in equation~\eqref{eq:hom_map}, these inclusions induce linear maps at level of homology. Though we consider primarily Rips filtrations in this effort, we will at times keep the notation simple and general by letting $K_\bullet$ denote any simplicial filtration. 
%Given a simplicial complex $K \subseteq \mathcal{P}(V)$ and a strictly increasing subset $\sigma = \{v_1, v_2, \dots, v_{p+1}\} \subseteq V$,
%satisfying $v_1 < v_2 < \dots < v_{p+1}$, 
An \emph{oriented $p$-simplex} $[\sigma]$ is an ordered set $[\sigma] = (-1)^{\lvert \pi \rvert } \left [v_{\pi(1)}, v_{\pi(2)}, \dots, v_{\pi(p+1)} \right ]$,
%\begin{equation}\label{eq:oriented_simplex}
%	[\sigma] = (-1)^{\lvert \pi \rvert } \left [v_{\pi(1)}, v_{\pi(2)}, \dots, v_{\pi(p+1)} \right ]
%\end{equation}
where $\pi$ is a permutation on $[\,p+1\,] = \{\, 1, 2, \dots, p+1 \, \}$ and $\lvert \pi \rvert$ the number of its inversions. 
%Any ordering defines the same oriented simplex if the permutation transforming one ordering into the other is even. 
The \emph{$p$-boundary} $\partial_p[\sigma]$ of an oriented $p$-simplex $[\sigma] \in K$ is defined as the alternating sum of its oriented co-dimension 1 faces, which collectively for all $\sigma \in K^p$ define the $p$-th \emph{boundary matrix} $\partial_p$ of $K$:
\begin{equation}\label{eq:alt_sum}
%\begin{equation}\label{eq:boundary_matrix}
%\end{equation}
	\partial_p[i,j] \triangleq \begin{cases}
		(-1)^{s_{ij}} & \sigma_i \in \partial[\sigma_j]  \\
		0 & \text{otherwise}
	\end{cases},
	\quad \quad  
	\partial_p[\sigma] \triangleq \sum_{i=1}^{p+1} (-1)^{i-1} [v_1, \dots, v_{i-1}, v_{i+1}, \dots v_{p+1}]	
\end{equation}
where $s_{ij} = \mathrm{sgn}([\sigma_i], \partial [\sigma_j])$ records the orientation. Extending~\eqref{eq:alt_sum} to all simplices in $\sigma \in K$ for all $p \leq \mathrm{dim}(K)$ yields the \emph{full boundary matrix} $\partial$. 
With a small abuse in notation, we use $\partial_p$ to denote both the boundary operator and its ordered matrix representative. When it is not clear from the context, we will clarify which representation is intended. 

%Since $\partial_p$ is completely characterized by the oriented $p$ and $p-1$ simplices of $(K, f)$, a matrix representative of $\partial_p$ can be obtained by setting all columns of $\partial$ corresponding to simplices of dimension $q \neq p$ to $0$. 

Generalizing beyond simplices, given a field $\mathbb{F}$, an \emph{oriented $p$-chain} is a formal $\mathbb{F}$-linear combination of oriented $p$-simplices of $K$ whose boundary $\partial_p[c]$ is defined linearly in terms of its constitutive simplices. 
The collection of $p$-chains under addition yields an $\mathbb{F}$-vector space $C_p(K)$ whose boundaries $c \in \partial_p[c']$ satisfying $\partial_p[c] = 0$ are called \emph{cycles}.
%We assume every $p$-chain is \emph{oriented} such that $K$ is an \emph{oriented simplicial complex}.
 Together, the collection of $p$-boundaries and $p$-cycles forms the groups $B_p(K) = \mathrm{Im}\,\partial_{p+1}$ and $Z_p(K) = \mathrm{Ker}\,\partial_p$, respectively. 
% Since $\partial_p \circ \partial_{p+1} = 0$ for all $p\geq 0$, 
The quotient space $H_p(K) = Z_p(K) / B_{p}(K)$ is 
 %a well-defined group 
 called the \emph{$p$-th homology group of $K$} with coefficients in $\mathbb{F}$ and its dimension $\beta_p$ is the \emph{$p$-th Betti number} of $K$.
% \begin{equation}
% 	H_p(K) \triangleq Z_p(K) / B_{p}(K), \quad \quad \beta_p(K) \triangleq \mathrm{dim}(H_p(K))
% \end{equation}
% The dimension of the $p$-th homology group $\beta_p(K)$ is called the \emph{$p$-th Betti number} of $K$.
 %TODO: insert sentence about betti == rank invariant, mention Mobius inversion 
% $\beta_p(K) = \mathrm{dim}(H_p(K))$ of $K$ is called the \emph{$p$-th Betti number} of $K$. 

%Let $B_p(K_\bullet) \subseteq Z_p(K_\bullet) \subseteq C_p(K_\bullet)$ denote the $p$-th boundary, cycle, and chain groups of a given filtration $K_\bullet$, respectively, and let $\partial_p : C_p( K_{\bullet}) \to C_{p-1}(K_{\bullet})$ denote the $p$-th boundary operator. 

%A \emph{filtration} $K_\bullet = \{K_a\}_{a\in I}$ is a family of complexes indexed by a 
%% NOTE: can't say totally ordered any more with (a,b) notation. 
%%totally ordered
%set $I$ such that $a \leq b \in I \Rightarrow K_a \subseteq K_b$. 
A \emph{filtration} is a pair $(K, f)$ where $f : K \to I$ is a \emph{filter function} over an index set $I$ satisfying $f(\tau) \leq f(\sigma)$ whenever $\tau \subseteq \sigma$, for any $\tau,\sigma \in K$. 
% Note: Since the index set may be \mathbb{R} and we're avoiding integer indices to avoid contrast, simplexwise notation no longer make sense. So we just have to make things super ambiguous and hope the reader will understand
%$K_\bullet$ is called \emph{simplexwise} if $K_b \smallsetminus K_a = \{\sigma_b\}$ whenever $b$ is the immediate successor of $a$ in $I$:
%Connecting a sequence of simplices $[\sigma_i]_{i=1, \dots, m}$ ordered increasingly by $f$ by inclusion yields such a family of complexes:
%\begin{equation}
%	\emptyset = K_0 \subsetneq K_1 \subsetneq \dots \subsetneq K_m  = K_\bullet, \quad K_i  = K_{i-1} \cup \{\sigma_i\}
%\end{equation} 
%% Note: again, we have to abandon the nice integer notation
%Given a filtration $K_\bullet = \{K_a\}_{a\in I}$ of size $\lvert K_\bullet \rvert = N$,  
%let $\Delta_{+} = \{ (i,j) : i < j, i, j \in \mathbb{R} \}$ denote the upper half-plane, 
%let $\Delta_{+}^N = \{ (i,j) : 0 \leq i \leq j \leq N \}$ denote the set of filtration index pairs. 
For every pair $(a,b) \in I \times I$ satisfying $a \leq b$, the sequence of inclusions $K_a \subseteq \dots \subseteq K_b$ induce linear transformations $h_p^{a,b} :  H_p(K_a) \to H_p(K_b)$ at the level of homology.
%\begin{equation}\label{eq:hom_map}
%	0 = H_p(K_0) \to \dots \to H_p(K_i) \underbracket[0.5pt]{\to \dots \to}_{h_p^{i,j}} H_p(K_j) \to \dots \to H_p(K_N) = H_p(K_\bullet) 
%\end{equation}
When $\mathbb{F}$ is a field, this sequence of homology groups uniquely decompose $(K,f)$ into a pairing $(\sigma_a, \sigma_b)$ demarcating the evolution of homology classes~\cite{zomorodian2004computing}: $\sigma_a$ marks the creation of a homology class, $\sigma_b$ marks its destruction, and the difference $\lvert a - b \rvert$ records the lifetime of the class, called its \emph{persistence}.
The persistent homology groups are the images of these maps and the persistent Betti numbers are their dimensions:
\begin{equation}
	H_{p}^{a,b} = \begin{cases}
	H_p(K_a) & a = b \\ 
 	\mathrm{Im}\,h_p^{a,b} & a < b
 \end{cases}
, \quad \quad 
\beta_p^{a,b} = \begin{cases}
 	\beta_p(K_a) & a = b \\
 	\mathrm{dim}(H_{p}^{a,b}) & a < b
 \end{cases}
\end{equation}
For a fixed $p \geq 0$, the collection of persistent pairs $(a, b)$ together with unpaired simplices $(c, \infty)$ form a summary representation $\mathrm{dgm}_p(K,f)$ called the \emph{$p$-th persistence diagram of $(K,f)$}. Conceptually, $\beta_p^{a,b}$ counts the number of persistent pairs lying inside the box $(-\infty, a\,] \times (\,b, \infty)$---the number of persistent homology groups born at or before $a$ that died sometime after $b$. % (see Figure~\ref{fig:mult}) 
When a given quantity depends on fixed parameters that are irrelevant or unknown, we use an asterisk. Thus, $H_p^\ast(K)$ refers to any homology group of $K$. 

%% Boundary matrix section --- since consistency in notation / avoidance of contrasting ideas is preferred over explicitness, this part has been dropped 
%With a small abuse in notation, we use both $\partial$ and $\partial_p$ to represent both boundary operators and their matrix representatives, i.e. $\partial$ may refer to either a generic boundary operator or the $N \times N$ filtered boundary matrix with respect to an ordered basis $(\sigma_i)_{1 \leq i \leq N}$ of a filtration $K_\bullet$:
%\begin{equation}\label{eq:boundary_matrix}
%	\partial[i,j] = \begin{cases}
%		(-1)^{s_{ij}} & \sigma_i \in \partial[\sigma_j], \; \text{where } s_{ij} = \mathrm{sgn}([\sigma_i], \partial [\sigma_j])  \\
%		0 & \text{otherwise}
%	\end{cases}
%\end{equation}
%Since $\partial_p$ is completely characterized by the oriented $p$ and $p-1$ simplices of $K_\bullet$,   the matrix representative of $\partial_p$ is obtained by setting all columns of $\partial$ corresponding to simplices of dimension $q \neq p$ to $0$. 


%\begin{remark}
%	We will often equivalently define a filtration $K_\bullet$ as a pair $(K, f)$ where $f : K \to I$ is a \emph{filter function} over an index set $I$---here, either $[n] = \{ 1, \dots, n\}$ or $\mathbb{R}$---satisfying $f(\tau) \leq f(\sigma)$ whenever $\tau \subseteq \sigma$, for any $\tau,\sigma \in K$. 
%Since any filtration may be converted into a simplexwise filtration via \emph{condensing}, \emph{refining}, and \emph{reindexing} maps~\cite{bauer2021ripser}, without loss of generality we consider them exclusively.

% NOTE: Time varying filtration is a family of monotone functions 
We will at times need to generalize the notation given thus far to the \emph{parameterized} setting. Towards this end, for some $\mathcal{A} \subseteq \mathbb{R}^d$, we define an \emph{$\mathcal{A}$-parameterized filtration} as a pair $(K, f_\alpha)$ where $K$ is a simplicial complex and $f : K \times \mathcal{A} \to \mathbb{R}$ an $\mathcal{A}$-parameterized filter function satisfying:
\begin{equation}
f_\alpha(\tau) \leq f_\alpha(\sigma) \;\, \forall \; \tau \subseteq \sigma \in K  \;\; \text{ and } \; \; f_\alpha(\sigma) \text{ is continuous in } \alpha \in \mathcal{A} \text{ for every } \sigma \in K
\end{equation}
%\begin{enumerate}
%	\item For every $\alpha \in \mathcal{A}$, $(K, f_\alpha)$ is a filtration satisfying $f_\alpha(\tau) \leq f_\alpha(\sigma)$ whenever $\tau \subseteq \sigma$, for any $\tau,\sigma \in K$
%	\item For every $\sigma \in K$, $f_\alpha(\sigma) : \mathbb{R} \to \mathbb{R}$ is a continuous function in $\alpha \in \mathcal{A}$
%\end{enumerate}
Intuitively, when $\mathcal{A} = \mathbb{R}$, one can think of $\alpha$ as a \emph{time} parameter (see Figure~\ref{fig:overview}) and each $f_\alpha(\sigma)$ as tracing a curve in $\mathbb{R}^2$ parameterized by $\alpha$.  
Examples of parameterized filtrations include:
\begin{itemize}[itemsep=0.25em, parsep=0.25em]
	\item (Constant filtration) For a filter $f : K \to \mathbb{R}$, let $(K, f_\alpha)$ denote the parameterized filtration obtained by declaring $f_\alpha(\sigma) = f(\sigma)$ for all $\alpha \in \mathcal{A}$ and all $\sigma \in K$. We refer to $(K, f_\alpha)$ as the \emph{constant filtration}. 
	\item (Dynamic Metric Spaces) For a finite set $X$, let $\gamma_X = (X, d_X(\cdot))$ denote a dynamic metric space~\cite{kim2021spatiotemporal}, where $d_X(\cdot) : \mathbb{R} \times X \times X$ denotes a time-varying metric. For any fixed $K \subset \mathcal{P}(X)$, the pair $(K, f_\alpha)$ obtained by setting $f_\alpha(\sigma) = \max_{x, x' \in \sigma} d_X(\alpha)(x,x')$ recovers the notion of a \emph{time-varying Rips filtration}.
	\item (Filter combinations) For $f, g: K \to \mathbb{R}$ filters over $K$, a natural family of filtrations $(K, h_\alpha)$ is obtained by $h_\alpha = (1 - \alpha) f + \alpha g$ for all $\alpha \in [0, 1]$, i.e. \emph{convex combinations} of $f$ and $g$.
	\item (Multi-filtrations) More generally, a $d$-dimensional filtration on the category of simplicial complexes $\mathbf{Simp}$ is a functor $\mathcal{F}: \mathbb{R}^d \to \mathbf{Simp}$ satisfying $\mathcal{F}(a, b) : \mathcal{F}_a \to \mathcal{F}_b$ an inclusion for all $a \leq b$~\cite{}. By fixing $K \in \mathbf{Simp}$ and letting $\mathcal{A} = \mathbb{R}^d$, we recover the notion of a \emph{multi-filtration}.
%	In this setting, we interpret $\mathcal{A}$ as parameterizing the product space of the chosen filters. 
\end{itemize} 


%In many such settings, it is of interest to ``exclude'' certain simplices $\tau \in K$ once they reach a certain threshold---we encapsulate this scenario by setting $f_\alpha(\tau) = 0$.
%\end{remark} 
%\begin{remark}
%\end{remark}
%Although the persistence diagram $\mathrm{dgm}_p(K_\bullet)$ characterizes elements of $H_p^{i,j}$, one may define $\mathrm{dgm}_p(K_\bullet)$ through $\beta_p^{i,j}$ alone. To see this, let $f: K \to \mathbb{R}$ be a tame function and $(\tau_i)$
%\begin{definition}
%The $p$-th persistence diagram $dgm_p(f) \subset \bar{\mathbb{R}}^2$ of a filtration induced by $f$ is the set of points $(a_i,a_j)$ drawn on the plane with non-zero multiplicity $\mu_p^{i,j}$, where: 
%  $$\mu_p^{i,j} = \left(\beta_p^{i,j\shortminus1} - \beta_p^{i,j} \right) - \left(\beta_p^{i\shortminus1,j\shortminus1} - \beta_p^{i\shortminus1,j} \right) \quad\quad \text{for } 0 < i < j \leq n+ 1 $$
%\end{definition}

%\begin{definition}[Persistence diagram]
%	Given a finite filtration $K_\bullet$ of , the $p$-th persistence diagram for some $p \geq 0$ is the set of points $(i,j)$ counted with multiplicity $\mu_p^{i,j}$ for all $0 < i < j < m+1$, union all the points on the diagonal, counted with infinite .  
%\end{definition}


%Note that if $i = j$, then $H_{p}^{i,j} = H_{p}(K_i) = H_{p}(K_i)$ is   just the ``standard'' homology. 
% Simplices whose inclusion in the filtration creates a new homology class are called \emph{creators}, and simplices that destroy homology classes are   called \emph{destroyers}. 
% The filtration indices of these creators/destroyers are referred to as \emph{birth} and \emph{death} times, respectively. 
%The collection of birth/death pairs $(i,j)$ is denoted $\mathrm{dgm}_p(K)$, and referred to as the $p$-th \emph{persistence diagram} of $K$.
%If a homology class is born at time $i$ and dies entering time $j$, the difference $\lvert i - j \rvert$ is called the \emph{persistence} of that class.
