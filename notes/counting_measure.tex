\newcommand\restr[2]{{% we make the whole thing an ordinary symbol
  \left.\kern-\nulldelimiterspace % automatically resize the bar with \right
  #1 % the function
  \vphantom{\big|} % pretend it's a little taller at normal size
  \right|_{#2} % this is the delimiter
  }}
  
 %For any $i,j \in \Delta_+$, define the \emph{multiplicity} $\mu_p^{i,j}$ of the pair $p = (i,j)$ by: 
%\begin{equation}
%	\mu_p^{i,j} = \beta_{p}^{i-1, j} - \beta_{p}^{i, j} + \beta_{p}^{i, j-1}  - \beta_{p}^{i-1, j-1}
%\end{equation}
%The multiplicity function is intimately linked with the persistence diagram. Indeed, the original definition of a persistence 

Both the persistent homology (PH) groups and their corresponding persistent Betti numbers (PBNs) have long been studied from multiple, equivalent perspectives by several authors, see~\cite{cerri2013betti, chazal2016structure, cohen2005stability, zomorodian2004computing} and references therein for an overview. 
%We recall a few characterizations which are illuminating in this effort.
From an algebraic perspective, Carlsson et al.~\cite{zomorodian2004computing} observed that the PH groups over a filtration may be viewed as the standard homology groups of a particular graded module $M$ over a polynomial ring. They also give a cubic-time algorithm to compute these groups on spaces in arbitrary dimensions over any field. 
%More recently, Bauer studied persistence in a form a matching. 
In~\cite{cohen2005stability}, Cohen-Steiner et al. give a more discrete perspective on PH by defining the persistence diagram in terms of a \emph{multiplicities}: given a tame function $f: \mathcal{X} \to \mathbb{R}$ over a topological space $\mathcal{X}$, its homological critical values $\{ a_i \}_{i=1}^n$, and an interleaved sequence $\{ b_i \}_{i=0}^n$ satisfying $b_{i-1} < a_i < b_i$ for all $1 \leq i \leq n$, the $p$-th persistence diagram over $f$ is given as: 
\begin{equation}
\mathrm{dgm}_p(f) = \{ \, (a_i, a_j) :  \mu_p^{i,j} \neq 0 \, \} \; \cup \; \Delta	
\end{equation}
%the set of points $(a_i,a_j)$ drawn on the plane with non-zero multiplicity $\mu_p^{i,j}$: 
where $\Delta$ denotes the diagonal, counted with infinite multiplicity, and $\mu_p^{i,j}$ is the  \emph{multiplicity function}, defined as: 
\begin{equation}\label{eq:multiplicity}
	\mu_p^{i,j} = \left(\beta_p^{i,j\shortminus1} - \beta_p^{i,j} \right) - \left(\beta_p^{i\shortminus1,j\shortminus1} - \beta_p^{i\shortminus1,j} \right) \quad\quad \text{for } 0 \leq i < j \leq n+ 1
\end{equation}
Equation~\eqref{eq:multiplicity} demonstrates an intrinsic connection between the multiplicity function and the persistent Betti numbers. Indeed, the fundamental lemma of persistent homology~\cite{edelsbrunner2022computational} states that for every pair of indices $0 \leq k \leq l \leq n+1$: 
\begin{equation}\label{eq:betti_mult}
	\beta_p^{k,l} = \sum\limits_{i \leq k} \sum\limits_{j > l} \mu_p^{i,j}
\end{equation}
After introducing several alternative notions of `tameness',~\cite{chazal2016structure} generalize~\eqref{eq:multiplicity} using measure-theoretic tools to prove the existence and stability of persistence diagram. In particular, for $M$ a decomposable persistence module over $\mathbb{R}$, Chazal~\cite{chazal2016structure} show that one may recover its persistence diagram by constructing its corresponding \emph{persistence measure}:
%re-define the multiplicity function by interpreting $\mu_p^\ast$ as a  $\mu_p(R; M)$. means that 
\begin{equation}\label{eq:measure}
	\mu_p(R; M) = \mathrm{card}\left( \,
	%\mathrm{dgm}_p(M)\restriction_R 
	\restr{\mathrm{dgm}_p(M)}{R} \,
	\right) \quad \text{ for all rectangles } R \subset \mathbb{R}^2 
\end{equation}
The essential perspective from~\eqref{eq:measure} is that the multiplicity function $\mu^\ast_p$ can be viewed as an integer-valued measure over rectangles in the plane. 
Cerri et al.~\cite{cerri2013betti} incorporate this interpretation in their work studying the stability of PBNs in multidimensional persistence by showing that \emph{proper cornerpoints} in the persistence diagram are points $x = (i,j) \in \Delta_+$ satisfying:
\begin{equation}\label{eq:pbn_cont}
	x = (i,j) \in \mathrm{dgm}_p(f) \; \Longleftrightarrow \; \mu_p(x) > 0 \; \Longleftrightarrow \; \min_{\epsilon > 0} \left(\beta_p^{i \+ \epsilon, j \shortminus \epsilon} - \beta_p^{i \+ \epsilon, j \+ \epsilon} \right) - \left(\beta_p^{i \shortminus \epsilon, j \shortminus \epsilon} - \beta_p^{i \shortminus \epsilon, j \+ \epsilon} \right) > 0
\end{equation}
One may compare~\eqref{eq:multiplicity} with~\eqref{eq:pbn_cont}. One of the primary contributions from~\cite{cerri2013betti} is a representation theorem (Theorem 3.11) expressing the persistent Betti number function $\beta_\ast : \Delta_+ \to \mathbb{N}\cup \{\infty\}$ as a sum of multiplicity functions, akin to~\eqref{eq:betti_mult}. 
A consequence of this theorem is that any distance between persistence diagrams induces a distance between PBN functions---if $X$ is a triangulable space and $f,g : X \to \mathbb{R}$ are two continuous functions, then $d(\beta_f, \beta_g) \leq \max\limits_{x \in X} \, \lvert f(x) - g(x) \rvert$, where:
\begin{equation*}\label{eq:pbn_stability}
	d(\beta_f, \beta_g) = \inf\limits_{\phi} \; \sup\limits_{p \in \mathrm{dgm}(f)} \lVert p - \phi(p) \rVert_{\widetilde{\infty} }
\end{equation*}
is the (extended) matching distance between PBN functions ($\beta_f$, $\beta_g$), $\phi$ ranges over all multi-bijections between $\mathrm{dgm}(f)$ and $\mathrm{dgm}(g)$, and $\lVert \,\cdot \, \rVert_{\widetilde{\infty}}$ measures the pseudo-distance~\cite{cerri2013betti} between points.
Thus, PBN functions are stable functions: small changes in continuous scalar-valued filtering functions imply small changes in the corresponding persistent Betti numbers functions, justifying their use and study in continuously parameterized settings. 

% TODO: move to computation section?
The customary interpretation of~\eqref{eq:betti_mult} is that persistence diagrams completely characterize their PBNs. This perspective has by and large driven the computational pipeline: if one has a space of interest $X$ and is interested in computing its PBNs $\beta_p^{i,j}$ for any choice of $i < j$, the standard approach is to first compute $\mathrm{dgm}_p(X)$ such that the corresponding PBNs can be read-off directly.
Nonetheless, the inverse interpretation via~\eqref{eq:betti_mult} has certain advantages. Its computation depends completely on the choice of indices $(i,j)$: if $\lvert i - j \rvert$ is small, the computation implies a localized computation. Moreover, if one has computed $\beta_p^{i,j}$ for some choice of $(i,j)$, the inner loop of the reduction algorithm from~\cite{edelsbrunner2022computational} suggests  $\beta_p^{i+1,j}$ or $\beta_p^{i,j+1}$ can be determined quadratic time. 
Indeed, if given diagram has a finite number of off-diagonal points, then in theory for~\eqref{eq:betti_mult} to hold it must be the case that one can recover the diagram with a finite number of PBN computations. 
Indeed, this fundamental observation lead~\cite{chen2011output} to create a divide-and-conquer like PH algorithm, wherein positional information about the diagram is accessed solely through $\mu$-queries---combinations of PBN-like computations.
% This was the first output-sensitive algorithm. 
%we generalize this In the spirit of~\eqref{eq:measure}, 

%Despite the duality between diagrams and PBNs, most practitioners work directly with former, not the latter. Indeed, though betti numbers have a certain computational advantages and are stable in the sense of~\eqref{eq:pbn_stability}, a number of barriers prevent their use in real-world settings. 
%For instance, the main stability theorem from~\cite{cohen2005stability} assumes that the underlying filtering function or persistence module is \emph{tame} and are defined over a triangulable space. Including this assumption guarantees the number of corner points will be finite and then ~\eqref{eq:pbn_stability} reduces to the bottleneck distance from~\cite{cohen2005stability}. In contrast, relaxing the assumption that such that  $f$ just continuous (as in equation~\eqref{eq:pbn_cont}) implies the number of corner points may be countably infinite, eliminating any hope of recovering the diagram from a finite set of multiplicity computations. 
%Moreover, although the matching distance between PBN functions $\beta_p(f), \, \beta_p(g)$ is appealing from both a theoretical and practical perspective due to its stability, computing the optimal matching distance requires both knowledge of the diagrams $\mathrm{dgm}_p(f), \, \mathrm{dgm}_p(g)$ themselves and the optimal bijections between them. 

%% Moreover, achieving the infimum in ... requires computing the optimal bijection ... between D(f), D(g), which takes O(...). 
%%one arrives at definitions of PBNs in the flavor of equation~\eqref{pbn_cont}. 




%Construct the persistence measure $\mu$
%we need to know that such a multiset exists and is unique. This is the
%content of Theorem 2.8, under the hypothesis that ÂµV is finite and additive.



%let DgmpVq be a multiset in the half-plane such that (*) holds for all rectangles R.
