\newcommand\restr[2]{{% we make the whole thing an ordinary symbol
  \left.\kern-\nulldelimiterspace % automatically resize the bar with \right
  #1 % the function
  \vphantom{\big|} % pretend it's a little taller at normal size
  \right|_{#2} % this is the delimiter
  }}
  
 %For any $i,j \in \Delta_+$, define the \emph{multiplicity} $\mu_p^{i,j}$ of the pair $p = (i,j)$ by: 
%\begin{equation}
%	\mu_p^{i,j} = \beta_{p}^{i-1, j} - \beta_{p}^{i, j} + \beta_{p}^{i, j-1}  - \beta_{p}^{i-1, j-1}
%\end{equation}
%The multiplicity function is intimately linked with the persistence diagram. Indeed, the original definition of a persistence 

The connection between the persistent homology (PH) groups and their corresponding persistent Betti numbers (PBNs) has long been studied from multiple perspectives by several authors~\cite{cerri2013betti, chazal2016structure, cohen2005stability, zomorodian2004computing}.
%We recall a few characterizations which are illuminating in this effort.
From an algebraic perspective, Carlsson et al.~\cite{zomorodian2004computing} observed that the PH groups over a filtration may be viewed as the standard homology groups of a particular graded module $M$ over a polynomial ring. 
%They also give a cubic-time algorithm to compute these groups on spaces in arbitrary dimensions over any field. 
%More recently, Bauer studied persistence in a form a matching. 
In~\cite{cohen2005stability}, Cohen-Steiner et al. give a more discrete perspective on PH by defining the persistence diagram in terms of a \emph{multiplicities}: given a tame function $f: \mathcal{X} \to \mathbb{R}$ over a topological space $\mathcal{X}$, its homological critical values $\{ a_i \}_{i=1}^n$, and an interleaved sequence $\{ b_i \}_{i=0}^n$ satisfying $b_{i-1} < a_i < b_i$ for all $1 \leq i \leq n$, the $p$-th persistence diagram over $f$ is given as: 
\begin{equation}
\mathrm{dgm}_p(f) = \{ \, (a_i, a_j) :  \mu_p^{i,j} \neq 0 \, \} \; \cup \; \Delta	
\end{equation}
%the set of points $(a_i,a_j)$ drawn on the plane with non-zero multiplicity $\mu_p^{i,j}$: 
where $\Delta$ denotes the diagonal, counted with infinite multiplicity, and $\mu_p^{i,j}$ is the  \emph{multiplicity function}, defined as: 
\begin{equation}\label{eq:multiplicity}
	\mu_p^{i,j} = \left(\beta_p^{i,j\shortminus1} - \beta_p^{i,j} \right) - \left(\beta_p^{i\shortminus1,j\shortminus1} - \beta_p^{i\shortminus1,j} \right) \quad\quad \text{for } 0 \leq i < j \leq n+ 1
\end{equation}
Equation~\eqref{eq:multiplicity} illuminates an intrinsic connection between the multiplicity function and the persistent Betti numbers. 
Namely, the inclusion-exclusion property that~\eqref{eq:multiplicity} obeys suggests that diagrams completely characterize their PBNs.
Indeed, the fundamental lemma of persistent homology~\cite{edelsbrunner2022computational} states that for every pair of indices $0 \leq k \leq l \leq n+1$: 
\begin{equation}\label{eq:betti_mult}
	\beta_p^{k,l} = \sum\limits_{i \leq k} \sum\limits_{j > l} \mu_p^{i,j}
\end{equation}
% TODO: move to computation section?
The direct consequence of~\eqref{eq:betti_mult} is that if one is interested in computing any of the PBNs of some space $\mathcal{X}$, then it is sufficient to compute $\mathrm{dgm}_p(\mathcal{X})$ and read them off directly. In this effort, as we will show, we will take the inverse mentality by recovering portions of the diagram via multiplicity evaluations.
%The focus of this effort inverts this mindset: we focus on recovering \emph{portions} of the diagram by fixing the the index pairs $(i,j)$ ahead of time.

%This fundamental observation inspired the divide-and-conquer PH algorithm given in~\cite{chen2011output}, wherein positional information about the diagram is accessed solely through $\mu$-queries on the unreduced boundary matrix.

% TODO: Intro this section with something like "Chazal showed you don't need decomposability to get the diagram, it's enough to construct a dgm's persistence measure---the "generalized" perspective on constructing diagrams from PBNs. Could even throw in Mobius inversion. Still good end with parameterized setting. 
The duality between diagrams and PBNs derived from persistence modules indexed over the real line was further studied by Chazal~\cite{chazal2016structure} in a measure-theoretic setting. 
By reinterpreting the multiplicity function $\mu^\ast_p$ as a certain kind of integer-valued measure over rectangles in the plane, a generalization of~\eqref{eq:multiplicity} 
%via measure-theoretic tools to prove the existence and stability of persistence diagram. ~\cite{chazal2016structure} 
was shown by demonstrating that one may recover the diagram of a persistence module $M$ over $\mathbb{R}$ by constructing its corresponding \emph{persistence measure}:
%re-define the multiplicity function by interpreting $\mu_p^\ast$ as a  $\mu_p(R; M)$. means that 
% After introducing several alternative notions of `tameness',
\begin{equation}\label{eq:measure}
	\mu_p(R; M) = \mathrm{card}\left( \,
	%\mathrm{dgm}_p(M)\restriction_R 
	\restr{\mathrm{dgm}_p(M)}{R} \,
	\right) \quad \text{ for all rectangles } R \subset \mathbb{R}^2 
\end{equation}
% The diagram exists wherever the measure takes finite values. 
Cerri et al.~\cite{cerri2013betti} incorporate this interpretation in studying the stability of PBNs in multidimensional persistence by showing that \emph{proper cornerpoints} are any points $x = (\, \hat\imath, \hat\jmath \,) \in \Delta_+$ satisfying $\mu_p(x) > 0$, where $\mu_p(x)$ is defined as:
%\begin{flalign}\label{eq:pbn_cont}
%	(\, \forall x =  (\, \hat\imath, \hat\jmath \,) \in \mathrm{dgm}_p(f) \,)  & & \quad\quad 
%	 \; \Longleftrightarrow \; \mu_p(x) := \; \min_{\delta > 0} \left(\beta_p^{\hat\imath \+ \delta, \hat\jmath  \shortminus \delta} - \beta_p^{\hat\imath \+ \delta, \hat\jmath  \+ \delta} \right) - \left(\beta_p^{\hat\imath \shortminus \delta, \hat\jmath \shortminus \delta} - \beta_p^{\hat\imath \shortminus \delta, \hat\jmath  \+ \delta} \right)
%\end{flalign}
\begin{equation}\label{eq:pbn_cont}
\mu_p(x) := \; \min_{\delta > 0} \left(\beta_p^{\hat\imath \+ \delta, \hat\jmath  \shortminus \delta} - \beta_p^{\hat\imath \+ \delta, \hat\jmath  \+ \delta} \right) - \left(\beta_p^{\hat\imath \shortminus \delta, \hat\jmath \shortminus \delta} - \beta_p^{\hat\imath \shortminus \delta, \hat\jmath  \+ \delta} \right)
\end{equation}
One may compare~\eqref{eq:multiplicity} with~\eqref{eq:pbn_cont}. One of the primary contributions from~\cite{cerri2013betti} is a representation theorem akin to~\eqref{eq:betti_mult} expressing the persistent Betti number function $\beta_\ast : \Delta_+ \to \mathbb{N} \, \cup \, \{\infty\}$ as a sum of multiplicity functions. 
A consequence of this theorem is that distances between diagrams induces a distance between PBN functions---if $X$ is a triangulable space and $f,g : X \to \mathbb{R}$ are two continuous functions, then $d(\beta_f, \beta_g) \leq \max\limits_{x \in X} \, \lvert f(x) - g(x) \rvert$, where:
\begin{equation*}\label{eq:pbn_stability}
	d(\beta_f, \beta_g) = \inf\limits_{\phi} \; \sup\limits_{p \in \mathrm{dgm}(f)} \lVert p - \phi(p) \rVert_{\widetilde{\infty} }
\end{equation*}
is the (extended) matching distance between PBN functions ($\beta_f$, $\beta_g$), $\phi$ ranges over all multi-bijections between $\mathrm{dgm}(f)$ and $\mathrm{dgm}(g)$, and $\lVert \,\cdot \, \rVert_{\widetilde{\infty}}$ measures the pseudo-distance~\cite{cerri2013betti} between points.
Thus, PBN functions are stable functions: small changes in continuous scalar-valued filtering functions imply small changes in the corresponding persistent Betti numbers functions. 

Like persistence diagrams, the stability of PBN functions justifies their use and study in continuously parameterized settings. Despite this, much of persistence-related research has concentrated on exploiting properties of the diagram itself~\cite{}, as opposed to the PBNs (\cite{cerri2013betti, chen2011output} are notable exceptions). 
% the connection between $\mu_p^\ast$ and $\beta_p^{\ast}$ elucidated by~\eqref{eq:betti_mult} implies
%Nonetheless, PBN computations exhibit certain advantages; 
%computing $\beta_p^{i,j}$ requires only (localized) knowledge of $(K_i, K_j)$; %(1)
%portions of $\mathrm{dgm}_p(K_\bullet)$ are counted by PBNs via~\eqref{eq:betti_mult}; %(2)
%%once $\beta_p^{i,j}$ has been obtained, $\beta_p^{i+1,j}$ or $\beta_p^{i,j+1}$ may be readily computed; 
%as a weaker invariant, a single PBN ought to be easier to compute that the full persistence diagram. %(3)
Nonetheless, as we shall show, there are certain advantages the PBN computation has over the ``standard'' reduction algorithm from~\cite{edelsbrunner2022computational}. 
Indeed,~\eqref{eq:multiplicity} implies one may in theory recover the diagram through [a finite number of] PBN computations alone via a divide-and-conquer like approach~\cite{chen2011output}, suggesting an alternative computational paradigm---distinct from the reduction family of algorithms---with which to approach the persistence computation. 

% This was the first output-sensitive algorithm. 
%we generalize this In the spirit of~\eqref{eq:measure}, 

%Despite the duality between diagrams and PBNs, most practitioners work directly with former, not the latter. Indeed, though betti numbers have a certain computational advantages and are stable in the sense of~\eqref{eq:pbn_stability}, a number of barriers prevent their use in real-world settings. 
%For instance, the main stability theorem from~\cite{cohen2005stability} assumes that the underlying filtering function or persistence module is \emph{tame} and are defined over a triangulable space. Including this assumption guarantees the number of corner points will be finite and then ~\eqref{eq:pbn_stability} reduces to the bottleneck distance from~\cite{cohen2005stability}. In contrast, relaxing the assumption that such that  $f$ just continuous (as in equation~\eqref{eq:pbn_cont}) implies the number of corner points may be countably infinite, eliminating any hope of recovering the diagram from a finite set of multiplicity computations. 
%Moreover, although the matching distance between PBN functions $\beta_p(f), \, \beta_p(g)$ is appealing from both a theoretical and practical perspective due to its stability, computing the optimal matching distance requires both knowledge of the diagrams $\mathrm{dgm}_p(f), \, \mathrm{dgm}_p(g)$ themselves and the optimal bijections between them. 

%% Moreover, achieving the infimum in ... requires computing the optimal bijection ... between D(f), D(g), which takes O(...). 
%%one arrives at definitions of PBNs in the flavor of equation~\eqref{pbn_cont}. 




%Construct the persistence measure $\mu$
%we need to know that such a multiset exists and is unique. This is the
%content of Theorem 2.8, under the hypothesis that ÂµV is finite and additive.



%let DgmpVq be a multiset in the half-plane such that (*) holds for all rectangles R.
